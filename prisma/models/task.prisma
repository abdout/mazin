// Task Management Model
// This file contains the Task model for clearance job tasks

model Task {
  id       String       @id @default(cuid())
  task     String       // Task title
  project  String       // Project reference (name)
  status   TaskStatus   @default(PENDING)
  priority TaskPriority @default(MEDIUM)
  category TaskCategory @default(GENERAL) // For auto-assignment rules

  // Details
  desc     String? @db.Text // Description
  label    String? // Category label
  duration String? // Estimated duration

  // Assignment
  assignedTo String[] @default([]) // Assigned team members

  // Dates
  date        DateTime? // Due date
  hours       Int?      // Actual hours spent
  completedAt DateTime? // When task was completed

  // Link to project stage for traceability
  linkedActivity    Json?              // { projectId, shipmentType, stage, substage, task }
  trackingStageType TrackingStageType? // Link to tracking stage

  // Relations
  projectId  String?
  projectRef Project? @relation(fields: [projectId], references: [id], onDelete: Cascade)

  userId String
  user   User   @relation(fields: [userId], references: [id])

  notifications Notification[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([status])
  @@index([category])
  @@index([projectId])
  @@index([userId])
  @@index([date])
  @@map("tasks")
}

enum TaskStatus {
  PENDING
  STUCK
  IN_PROGRESS
  DONE
}

enum TaskPriority {
  URGENT
  HIGH
  MEDIUM
  LOW
}

// Task categories for auto-assignment rules
enum TaskCategory {
  DOCUMENTATION
  CUSTOMS_DECLARATION
  PAYMENT
  INSPECTION
  RELEASE
  DELIVERY
  GENERAL
}
